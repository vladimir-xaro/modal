var main;main=function(){"use strict";var t={516:function(t,i,e){e.r(i),e.d(i,{default:function(){return u}});var s=class{constructor(t={}){this.events={};for(let i in t)t[i]&&this.subscribe(i,t[i])}subscribe(t,i){this.has(t)||(this.events[t]=[]);let e=[];if(Array.isArray(i))for(const s of i)e.push(...this.subscribe(t,s));else this.events[t].push(i),e.push((()=>this.removeListener(t,i)));return e}unsubscribe(...t){for(const i of t)this.events[i]&&delete this.events[i]}removeListener(t,i){if(Array.isArray(this.events[t])){const e=this.events[t].indexOf(i);e>-1&&this.events[t].splice(e,1)}}once(t,i){const e=this.subscribe(t,(()=>{if(e[0](),Array.isArray(i))for(const t of i)t();else i()}))}has(t){return!!this.events[t]}listenerCount(t){return!!this.events.hasOwnProperty(t)&&this.events[t].length}emit(t,...i){const e=this.events[t];if(e)for(let t of e)t(...i)}validateEmit(t,...i){const e=this.events[t];if(!e)return!1;for(const t of e)if(!t(...i))return!1;return!0}seriesEmit(t,...i){const e=this.events[t];if(!e)return;let s;for(let t=0;t<e.length;t++)s=0===t?e[t](...i):e[t](s);return s}};function n(...t){const i=Object(t[0]);for(let e=1;e<t.length;e+=1){const s=t[e];if(null!=s){const t=Object.keys(Object(s));for(let e=0,c=t.length;e<c;e+=1){const c=t[e],a=Object.getOwnPropertyDescriptor(s,c);void 0!==a&&a.enumerable&&(o(i[c])&&o(s[c])?n(i[c],s[c]):!o(i[c])&&o(s[c])?(i[c]={},n(i[c],s[c])):i[c]=s[c])}}}return i}function o(t){return"object"==typeof t&&null!==t&&t.constructor&&t.constructor===Object}const c={id:null,el:null,visible:!1,attr:{close:"data-modal-close",target:"data-modal-target",id:"data-modal-id"},allow:{bodyScroll:!1,closeEsc:!0,closeAttr:!0,closeOutside:!0},classes:{visible:"modal--visible"},container:{el:null,wrapper:null,mutation:"animation",timeout:null,animation:!1,timeouts:{animation:0,transition:100},properties:{selector:".modal__container",classes:{animation:{cancel:"modal-animation--cancel",show:"modal-animation-container--show",hide:"modal-animation-container--hide"},transition:{cancel:"modal-transition--cancel",show:"modal-transition-container--show",hide:"modal-transition-container--hide"},common:{show:"modal-container--hide",hide:"modal-container--hide"}}}},backdrop:{mutation:"animation",timeouts:{animation:0,transition:50},properties:{classes:{visible:"modal-backdrop--visible",animation:{cancel:"modal-animation--cancel",show:"modal-animation-backdrop--show",hide:"modal-animation-backdrop--hide"},transition:{cancel:"modal-transition--cancel",show:"modal-transition-backdrop--show",hide:"modal-transition-backdrop--hide"},common:{show:"modal-backdrop--show",hide:"modal-backdrop--hide"}}}},user:{}},a={animationstart:"__mutationStartListener",animationcancel:"__mutationCancelListener",animationend:"__mutationEndListener",animationiteration:"__mutationIterationListener",transitionstart:"__mutationStartListener",transitioncancel:"__mutationCancelListener",transitionend:"__mutationEndListener",transitionrun:"__mutationRunListener"},r=Object.keys(a);function l(t,i){"string"==typeof i?t.push(...document.querySelectorAll(i)):i instanceof Element&&t.push(i)}var h=class{constructor(t){if(this.els=[],this.emitter=new s(t.on),Array.isArray(t.el))for(const i of t.el)l(this.els,i);else l(this.els,t.el);t.allow?this.allow=t.allow.filter((t=>r.includes(t))):t.disallow?this.allow=r.filter((i=>!t.disallow.includes(i))):this.allow=r;for(const t in a)this[a[t]]=this[a[t]].bind(this);for(const t of this.els)for(const i of this.allow)t.addEventListener(i,this[a[i]])}__mutationStartListener(t){this.emitter.emit("start",this,t)}__mutationCancelListener(t){this.emitter.emit("cancel",this,t)}__mutationEndListener(t){this.emitter.emit("end",this,t)}__mutationIterationListener(t){this.emitter.emit("iteration",this,t)}__mutationRunListener(t){this.emitter.emit("run",this,t)}addEvent(t){if(this.allow.includes(t))for(const i of this.els)i.addEventListener(t,this[a[t]])}removeEvent(t){if(this.allow.includes(t))for(const i of this.els)i.removeEventListener(t,this[a[t]])}addClass(...t){for(const i of this.els)i.classList.add(...t);return this.els}removeClass(...t){for(const i of this.els)i.classList.remove(...t);return this.els}css(t){for(const i of this.els)for(const e in t)i.style[e]=t[e];return this.els}on(t,i){this.emitter.subscribe(t,i)}};const d={el:null,visible:!1,mutation:"animation",animation:null,timeout:null};class m{constructor(t={}){if(m.instances.push(this),this.index=m.instances.length-1,this.config=n({},d,t),!this.config.el){const t=document.createElement("div");t.classList.add("modal-backdrop"),document.body.append(t),this.config.el=t}this.emitter=new s,this.animation=new h({el:this.config.el,allow:["animationend","transitionend"],on:{end:t=>{this.emitter.emit("mutationEnd",this,t)}}})}unsubscribeMutation(){this.emitter.unsubscribe("mutationEnd")}}m.instances=[],m.current=null;class f{constructor(t){this.pending=!1,f.instances.push(),this.index=f.instances.length-1;let i=this.initConfig(c,t);if(this.config=i,this.config.user=t,this.emitter=new s(this.config.user.on),"string"==typeof t.el){const i=document.querySelector(t.el);if(!i)throw new Error("Element does not exists");this.config.el=i}if(this.config.id||(this.config.id=this.config.el.getAttribute(this.config.attr.id)||"__modal-"+(f.instances.length-1)),this.backdrop=m.instances.length?m.instances[m.instances.length-1]:new m,!this.config.container.el){const t=this.config.el.querySelector(".modal__container");if(!t)throw new Error("[Modal] Container does not exists");this.config.container.el=t}this.config.allow.closeAttr&&(this.__closeAttrListener=this.__closeAttrListener.bind(this)),this.config.allow.closeEsc&&(this.__closeEscListener=this.__closeEscListener.bind(this)),this.config.container.mutation&&(this.animation=new h({el:this.config.container.el,allow:[this.config.container.mutation+"end"],on:{end:t=>{this.emitter.emit("containerMutationEnd",this,t)}}}));for(const t of document.querySelectorAll(`[${this.config.attr.target}]`))t.getAttribute(this.config.attr.target)===this.config.id&&t.addEventListener("click",(()=>this.show()));this.config.allow.closeOutside&&(this.__wrapperClickListener=this.__wrapperClickListener.bind(this),this.config.el.addEventListener("click",this.__wrapperClickListener)),this.emitter.emit("init",this),this.config.visible&&this.show({force:!0})}initConfig(t,i){let e={};for(const s in t)i.hasOwnProperty(s)?o(t[s])&&o(i[s])?e[s]=this.initConfig(t[s],i[s]):e[s]=i[s]:e[s]=t[s];return e}__wrapperClickListener(t){t.target===this.config.el&&(this.emitter.emit("outsideClick",this,t),this.hide())}__closeAttrListener(t){this.hide(),this.emitter.emit("closeAttrClick",this,t)}__closeEscListener(t){t.stopPropagation(),"Escape"===t.code&&(this.hide(),this.emitter.emit("escKey",this,t))}addListeners(){if(this.config.allow.closeAttr){const t=this.config.el.querySelectorAll(`[${this.config.attr.close}]`);for(const i of t)i.addEventListener("click",this.__closeAttrListener)}this.config.allow.closeEsc&&document.addEventListener("keyup",this.__closeEscListener)}removeListeners(){if(this.config.allow.closeAttr){const t=this.config.el.querySelectorAll(`[${this.config.attr.close}]`);for(const i of t)i.removeEventListener("click",this.__closeAttrListener)}this.config.allow.closeEsc&&document.removeEventListener("keyup",this.__closeEscListener)}mutationEndCallback(t,i,e){if(t){if(this.config.container.animation=!1,this.backdrop&&this.backdrop.config.animation)return}else if(this.backdrop&&(this.backdrop.config.animation=!1,this.config.container.animation))return;this.pending=!1,i&&(this.config.el.classList.remove(this.config.classes.visible),this.backdrop?.config.el.classList.remove(this.config.backdrop.properties.classes.visible)),this.emitter.emit("Hide",this,e)}show(t){if(this.config.visible&&!t?.force)return;this.config.container.timeout&&clearTimeout(this.config.container.timeout),this.backdrop&&this.backdrop.config.timeout&&clearTimeout(this.backdrop.config.timeout);const i=this.config.el;this.config.container.el;if(this.pending){if(this.config.container.mutation){const t=this.config.container.mutation;this.animation.addClass(this.config.container.properties.classes[t].cancel)}if(this.backdrop&&this.config.backdrop.mutation){const t=this.config.backdrop.mutation;this.backdrop.animation.addClass(this.config.backdrop.properties.classes[t].cancel)}}if(this.emitter.emit("beforeShow",this),this.config.visible=!0,document.activeElement&&document.hasFocus()&&(f.blurEl=document.activeElement,document.activeElement.blur()),this.pending=!0,this.config.container.mutation){const t=this.config.container.mutation;this.animation.removeClass(this.config.container.properties.classes[t].hide,this.config.container.properties.classes[t].cancel)}if(this.backdrop&&this.config.backdrop.mutation){const t=this.config.backdrop.mutation;this.backdrop.animation.removeClass(this.config.backdrop.properties.classes[t].hide,this.config.backdrop.properties.classes[t].cancel)}if(i.classList.add(this.config.classes.visible),this.addListeners(),this.config.container.mutation){const t=this.config.container.mutation;this.config.container.animation=!0,+this.config.container.timeouts[t]>0?this.config.container.timeout=setTimeout((()=>{this.animation.addClass(this.config.container.properties.classes[t].show)}),this.config.container.timeouts[t]):this.animation.addClass(this.config.container.properties.classes[t].show)}else this.animation.addClass(this.config.container.properties.classes.common.show);if(this.backdrop)if(this.backdrop.config.el.classList.add(this.config.backdrop.properties.classes.visible),this.config.backdrop.mutation){const t=this.config.backdrop.mutation;this.backdrop.config.animation=!0,+this.config.backdrop.timeouts[t]>0?this.backdrop.config.timeout=setTimeout((()=>{this.backdrop.animation.addClass(this.config.backdrop.properties.classes[t].show)}),this.config.backdrop.timeouts[t]):this.backdrop.animation.addClass(this.config.backdrop.properties.classes[t].show)}else this.backdrop.animation.addClass(this.config.backdrop.properties.classes.common.show);this.config.allow.bodyScroll||(document.body.style.overflow="hidden",document.body.style.height="100vh"),this.config.container.mutation&&this.emitter.once("containerMutationEnd",(t=>this.mutationEndCallback(!0,!1,t))),this.backdrop&&this.config.backdrop.mutation&&this.backdrop.emitter.once("mutationEnd",(t=>this.mutationEndCallback(!1,!1,t))),this.config.container.mutation||this.config.backdrop.mutation||this.emitter.emit("afterShow",this)}hide(t){if(!this.config.visible&&!t?.force)return;this.config.container.timeout&&clearTimeout(this.config.container.timeout),this.backdrop&&this.backdrop.config.timeout&&clearTimeout(this.backdrop.config.timeout);const i=this.config.el,e=this.config.container.el;if(this.pending){if(this.config.container.mutation){const t=this.config.container.mutation;e.classList.add(this.config.container.properties.classes[t].cancel)}if(this.backdrop&&this.config.backdrop.mutation){const t=this.config.backdrop.mutation;this.backdrop.config.el.classList.add(this.config.backdrop.properties.classes[t].cancel),this.backdrop.emitter.unsubscribe("mutationEnd")}this.emitter.unsubscribe("containerMutationEnd")}if(this.emitter.emit("beforeHide",this),this.removeListeners(),this.config.visible=!1,this.pending=!0,this.config.container.mutation){const t=this.config.container.mutation;this.config.container.animation=!0,e.classList.remove(this.config.container.properties.classes[t].show,this.config.container.properties.classes[t].cancel),e.classList.add(this.config.container.properties.classes[t].hide)}else e.classList.remove(this.config.container.properties.classes.common.show);if(this.backdrop)if(this.config.backdrop.mutation){const t=this.config.backdrop.mutation;this.backdrop.config.animation=!0,this.backdrop.config.el.classList.remove(this.config.backdrop.properties.classes[t].show,this.config.backdrop.properties.classes[t].cancel),this.backdrop.config.el.classList.add(this.config.backdrop.properties.classes[t].hide)}else this.backdrop.config.el.classList.remove(this.config.backdrop.properties.classes.common.show);f.blurEl&&f.blurEl.focus(),f.blurEl=null,this.config.allow.bodyScroll||(document.body.style.overflow="",document.body.style.height=""),this.config.container.mutation&&this.emitter.once("containerMutationEnd",(t=>this.mutationEndCallback(!0,!0,t))),this.backdrop&&this.config.backdrop.mutation&&this.backdrop.emitter.once("mutationEnd",(t=>this.mutationEndCallback(!1,!0,t))),this.backdrop?this.config.container.mutation||this.config.backdrop.mutation||(i.classList.remove(this.config.classes.visible),this.emitter.emit("afterHide",this)):this.config.container.mutation||(i.classList.remove(this.config.classes.visible),this.emitter.emit("afterHide",this))}toggle(t){this.config.visible?this.hide(t):this.show(t)}}f.instances=[],f.blurEl=null;var u=f}},i={};function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{}};return t[s](n,n.exports,e),n.exports}return e.d=function(t,i){for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e(516)}();
//# sourceMappingURL=main.umd.min.js.map